<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¯æ—¥å“¡å·¥é»åç³»çµ±</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      background: #f3f4f6;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1000px;
      margin: auto;
      background: white;
      padding: 20px;
      margin-top: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    }
    h1 {
      text-align: center;
    }
    .info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .btn-area {
      margin: 10px 0;
      display: flex;
      gap: 10px;
    }
    select, button {
      padding: 6px 10px;
      font-size: 14px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    .status-btns button {
      margin: 2px;
    }
    .highlight {
      background: #e5e7eb;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>æ¯æ—¥å“¡å·¥é»åç³»çµ±</h1>
    <div class="info">
      <div>ğŸ“… æ—¥æœŸï¼š<span id="todayDate"></span> <span id="currentTime"></span></div>
      <div>
        ğŸ‘¤ é»åäººï¼š
        <select id="rollcallBy">
          <option value="é™³å©·åªš">é™³å©·åªš</option>
          <option value="é™³å§¿è“‰">é™³å§¿è“‰</option>
          <option value="é™³ä½³å®œ">é™³ä½³å®œ</option>
          <option value="å³æ·‘è“®">å³æ·‘è“®</option>
        </select>
      </div>
      <div>
        ğŸ•’ æ™‚æ®µï¼š
        <select id="rollcallSession">
          <option value="ä¸Šåˆ">ä¸Šåˆ</option>
          <option value="ä¸­åˆ">ä¸­åˆ</option>
        </select>
      </div>
    </div>

    <div class="btn-area">
      <button onclick="exportPDF()">ğŸ“„ åŒ¯å‡º PDF</button>
      <button onclick="exportCSV()">ğŸ“ åŒ¯å‡º CSV</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>å“¡å·¥ç·¨è™Ÿ</th>
          <th>å§“å</th>
          <th>éƒ¨é–€</th>
          <th>ç‹€æ…‹</th>
          <th>æ“ä½œ</th>
        </tr>
      </thead>
      <tbody id="employeeTable"></tbody>
    </table>
  </div>

  <script>
    const employees = [
      { id: "0011", name: "é‚±ç‘çµ±", dept: "æ¨¡ç™¼éƒ¨" },
      { id: "0004", name: "é™³æ°´æ³¢", dept: "æ¨¡ç™¼éƒ¨" },
      { id: "0400", name: "è¶™ç‰èŠ¬", dept: "æ¨¡ç™¼éƒ¨" },
      { id: "0405", name: "è‘‰å€¢ç¾½", dept: "æ¨¡ç™¼éƒ¨" },
      { id: "0494", name: "ç‹æœ‹æ¥¹", dept: "æ¨¡ç™¼éƒ¨" },
      { id: "0531", name: "è¨±å˜‰ç´“", dept: "æ¨¡ç™¼éƒ¨" },
      { id: "0538", name: "ä½•æ–‡æ³°", dept: "æ¨¡ç™¼éƒ¨" },
      { id: "0328", name: "è³´æ¦®æ¨‚", dept: "åŸºæéƒ¨" },
      { id: "0495", name: "è³´è‡´éŒ¡", dept: "åŸºæéƒ¨" },
      { id: "0507", name: "é˜¿ç™¼", dept: "åŸºæéƒ¨" },
      { id: "0517", name: "é»æ–‡å…¨", dept: "åŸºæéƒ¨" },
      { id: "0541", name: "èŒƒåº­é€²", dept: "åŸºæéƒ¨" },
      { id: "0559", name: "é˜®ç¶­å³°", dept: "åŸºæéƒ¨" },
      { id: "0663", name: "ä¼¸è¿ª", dept: "åŸºæéƒ¨" },
      { id: "0042", name: "è•­æ™¯æ± ", dept: "åŒ…è£éƒ¨" },
      { id: "0016", name: "æ–½å¦™è", dept: "åŒ…è£éƒ¨" },
      { id: "V002", name: "ææ…§ç²", dept: "åŒ…è£éƒ¨" },
      { id: "0003", name: "å³æ·‘ç¾", dept: "åŒ…è£éƒ¨" },
      { id: "0152", name: "é™³åª›ç²", dept: "åŒ…è£éƒ¨" },
      { id: "0287", name: "æ›¹å·§ä¼¶", dept: "åŒ…è£éƒ¨" },
      { id: "0482", name: "æœ±ç®è±", dept: "åŒ…è£éƒ¨" },
      { id: "0511", name: "æ–‡æ°é›ªè²", dept: "åŒ…è£éƒ¨" },
      { id: "0012", name: "é»ƒç§€é‰—", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0226", name: "é˜®æ°æ", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0402", name: "è”¡é´»æ¨¡", dept: "ç®¡ç†éƒ¨" },
      { id: "0017", name: "æ´ªå§ƒå»·", dept: "ç®¡ç†éƒ¨" },
      { id: "0297", name: "é™³æ·‘é¸", dept: "ç®¡ç†éƒ¨" },
      { id: "0304", name: "å³æ·‘è“®", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0473", name: "é™³å©·åªš", dept: "ç®¡ç†éƒ¨" },
      { id: "0514", name: "é™³å§¿è“‰", dept: "ç®¡ç†éƒ¨" },
      { id: "0515", name: "é™³ä½³å®œ", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0552", name: "é™³å…è–°", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0399", name: "è±†æ°åŠ‰", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0465", name: "æ–½ä¿å®£", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0479", name: "å¸Œè’‚", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0487", name: "å°¤å¦®", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0513", name: "æ–æ°ç§‹", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0519", name: "æ›¹å­œå­œ", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0520", name: "èŠå‡¡æ½”", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0526", name: "é»ƒæ°ç²", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0527", name: "é˜®æ°å¤¢", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0533", name: "é™¶æ°é‡‘éŠ€", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0539", name: "é˜®æ°ç„¶", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0547", name: "åœ˜æ°æœˆ", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0548", name: "æ²³æ°ç‡•", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0555", name: "æŠ¼æ°é€š", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0660", name: "èŒƒæ°é»ƒç§‹", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0661", name: "é™³æ°å¿ƒ", dept: "ç”Ÿç”¢éƒ¨" },
      { id: "0662", name: "èŒƒæ°æ¢…", dept: "ç”Ÿç”¢éƒ¨" }
    ];

    function renderTable() {
      const tbody = document.getElementById("employeeTable");
      tbody.innerHTML = "";
      employees.forEach(emp => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${emp.id}</td>
          <td>${emp.name}</td>
          <td>${emp.dept}</td>
          <td id="status-${emp.id}">æœªé»å</td>
          <td class="status-btns">
            <button onclick="setStatus('${emp.id}', 'å‡ºå¸­')">å‡ºå¸­</button>
            <button onclick="setStatus('${emp.id}', 'è«‹å‡')">è«‹å‡</button>
            <button onclick="setStatus('${emp.id}', 'æ› è·')">æ› è·</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function setStatus(id, status) {
      document.getElementById(`status-${id}`).textContent = status;
      saveData();
    }

    function saveData() {
      const data = [];
      employees.forEach(emp => {
        const status = document.getElementById(`status-${emp.id}`).textContent;
        data.push({ id: emp.id, name: emp.name, dept: emp.dept, status });
      });
      localStorage.setItem("rollcallData", JSON.stringify(data));
    }

    function loadData() {
      const saved = JSON.parse(localStorage.getItem("rollcallData") || "[]");
      saved.forEach(item => {
        const cell = document.getElementById(`status-${item.id}`);
        if (cell) cell.textContent = item.status;
      });
    }

    function exportCSV() {
      let csv = "ç·¨è™Ÿ,å§“å,éƒ¨é–€,ç‹€æ…‹\n";
      employees.forEach(emp => {
        const status = document.getElementById(`status-${emp.id}`).textContent;
        csv += `${emp.id},${emp.name},${emp.dept},${status}\n`;
      });
      const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
      const link = document.createElement("a");
      const today = new Date().toISOString().slice(0, 10);
      link.setAttribute("href", URL.createObjectURL(blob));
      link.setAttribute("download", `${today}_é»åç´€éŒ„.csv`);
      link.click();
    }

    function exportPDF() {
      window.print();
    }

    function updateClock() {
      const now = new Date();
      document.getElementById("todayDate").textContent = now.toLocaleDateString("zh-TW");
      document.getElementById("currentTime").textContent = now.toLocaleTimeString("zh-TW");
    }

    setInterval(updateClock, 1000);
    renderTable();
    loadData();
  </script>
</body>
</html>
